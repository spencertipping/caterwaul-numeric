Linear algebra for Caterwaul

At some point in the future this will include some really smashing optimizations.
Right now it doesn't work.
